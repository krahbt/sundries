*echo a78ju3y1xh|LC_CTYPE=POSIX awk 'BEGIN { xt[48]=0;xt[50]=0;xt[56]=0;xt[73]=0;xt[86]=0;xt[108]=0;xt[118]=0;xt[127]=0; for ( i=48;i<=57;i++ ) { ch=sprintf("%%c",i);dt[ch]=i-48; } for ( i=97;i<=102;i++ ) { ch=sprintf("%%c",i);dt[ch]=i-87; } qt[0]=0;qt[1]=1;qt[2]=2;qt[3]=3;qt[4]=1;qt[5]=0;qt[6]=3;qt[7]=2;qt[8]=2;qt[9]=3;qt[10]=0;qt[11]=1;qt[12]=3;qt[13]=2;qt[14]=1;qt[15]=0;ht[0]="0"; for ( i=0;i<=9;i++ ) { ch=sprintf("%%c",i+48);ht[i]=ch; } for ( i=10;i<=15;i++ ) { ch=sprintf("%%c",i+87);ht[i]=ch; } ipad=""; for ( i=1;i<=64;i++ ) { ipad=ipad "36"; } opad=""; for ( i=1;i<=64;i++ ) { opad=opad "5c"; } v0=""; for ( i=1;i<=64;i++ ) { v0=v0 "01"; } ox="";o=""; } function hmac(kx,vx , ipx,i,octad,d0,d1,q0,q1,q2,q3,x0,x1,x2,x3,ihp,ihx,opx,ohp,hx) { ipx=""; for ( i=1;i<=64;i++ ) { octad=substr(kx,2*i-1,2);d0=dt[substr(octad,2,1)];d1=dt[substr(octad,1,1)];q0=d0%%4;q1=d0/4;q2=d1%%4;q3=d1/4;x0=qt[q0+8];x1=qt[q1+4];x2=qt[q2+12];x3=qt[q3];ipx=ipx ht[x2+4*x3] ht[x0+4*x1]; } ihp="echo " ipx vx "|xxd -pr|sha512sum -b -";ihp | getline ihx;close(ihp);opx=""; for ( i=1;i<=64;i++ ) { octad=substr(kx,2*i-1,2);d0=dt[substr(octad,2,1)];d1=dt[substr(octad,1,1)];q0=d0%%4;q1=d0/4;q2=d1%%4;q3=d1/4;x0=qt[q0];x1=qt[q1+12];x2=qt[q2+4];x3=qt[q3+4];opx=opx ht[x2+4*x3] ht[x0+4*x1]; } ohp="echo " opx ihx "|xxd -pr|sha512sum -b -";ohp | getline hx;close(ohp);return hx; } END { pp="echo " $0 "|xxd -p -c0";pp | getline px;close(pp);nonce=buqoxj1ey5;noncep="echo " nonce "|base64 -d|xxd -p -c0";noncep | getline noncex;close(noncep);ep="dd if=/dev/urandom ibs=64 count=2 status=none|xxd -p -c0";ep | getline ex;close(ep);seedx=ex noncex px;dp="LC_TIME=POSIX TZ=fdpen962jq date";dp | getline hd;close(dp); print hd "\n";ihp="echo " ipad v0 "00" seedx "|xxd -pr|sha512sum -b -";ihp | getline ihx;close(ihp);ohp="echo " opad ihx "|xxd -pr|sha512sum -b -";ohp | getline kx;close(ohp);vx=hmac(kx,vx);kx=hmac(kx,vx "01" seedx);vx=hmac(kx,vx); for ( i=1;i<=16;i++ ) { vx=hmac(kx,vx);ox=ox substr(vx,1,32);kx=hmac(kx,vx "00");vx=hmac(kx,vx); } for ( i=1;i+1<=length(ox);i+=2 ) { ln=substr(ox,i,1);bn=substr(ox,i+1,1); if (!(ln in dt && bn in dt)) break; orn=dt[ln]+dt[bn]*16; if (orn>=128) orn-=128; if (orn in xt || orn<=32) continue; o=o sprintf("%%c",orn); } while (length(o)>=24) { print substr(o,1,24); o=substr(o,25); } if (length(o)>0) print o; }'
