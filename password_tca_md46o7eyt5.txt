*echo a78ju3y1xh|LC_CTYPE=POSIX awk 'BEGIN { ipad="";opad="";v0=""; for ( i=1;i<=64;i++ ) { ipad=ipad "36";opad=opad "5c";v0=v0 "01"; } x["30"]="3";x["31"]="2";x["32"]="1";x["33"]="0";x["34"]="7";x["35"]="6";x["36"]="5";x["37"]="4";x["38"]="b";x["39"]="a";x["3a"]="9";x["3b"]="8";x["3c"]="f";x["3d"]="e";x["3e"]="d";x["3f"]="c";x["50"]="5";x["51"]="4";x["52"]="7";x["53"]="6";x["54"]="1";x["55"]="0";x["56"]="3";x["57"]="2";x["58"]="d";x["59"]="c";x["5a"]="f";x["5b"]="e";x["5c"]="9";x["5d"]="8";x["5e"]="b";x["5f"]="a";x["60"]="6";x["61"]="7";x["62"]="4";x["63"]="5";x["64"]="2";x["65"]="3";x["66"]="0";x["67"]="1";x["68"]="e";x["69"]="f";x["6a"]="c";x["6b"]="d";x["6c"]="a";x["6d"]="b";x["6e"]="8";x["6f"]="9";x["c0"]="c";x["c1"]="d";x["c2"]="e";x["c3"]="f";x["c4"]="8";x["c5"]="9";x["c6"]="a";x["c7"]="b";x["c8"]="4";x["c9"]="5";x["ca"]="6";x["cb"]="7";x["cc"]="0";x["cd"]="1";x["ce"]="2";x["cf"]="3";b["0"]="0";b["1"]="1";b["2"]="2";b["3"]="3";b["4"]="4";b["5"]="5";b["6"]="6";b["7"]="7";b["8"]="0";b["9"]="1";b["a"]="2";b["b"]="3";b["c"]="4";b["d"]="5";b["e"]="6";b["f"]="7";d["20"]="";d["30"]="";d["32"]="";d["38"]="";d["49"]="";d["56"]="";d["6c"]="";d["76"]="";d["7f"]="";h["0"]="";h["1"]="";ox="";o=""; } function sha512(mx , hp,hx) { hp="(xxd -pr <<<" mx ")|sha512sum -b -";hp | getline hx;close(hp);return hx; } function hmac(kx,vx , ipx,opx,i,h) { ipx="";opx=""; for ( i=1;i<=128;i+=2 ) { ipx=ipx x["3" substr(kx,i,1)] x["6" substr(kx,i+1,1)];opx=opx x["5" substr(kx,i,1)] x["c" substr(kx,i+1,1)]; } h=sha512(ipx vx);h=sha512(opx h); return h; } function drbg44(d44,xx , kx,vx) { vx=substr(xx,129,128);kx=hmac(substr(xx,1,128),vx "00" d44);vx=hmac(kx,vx);kx=hmac(kx,vx "01" d44);vx=hmac(kx,vx);return (kx vx); } END { pp="xxd -p -c0 <<<" $0;pp | getline px;close(pp);nonces=buqoxj1ey5;noncep="(base64 -d <<<" nonces ")|xxd -p -c0";noncep | getline noncex;close(noncep);ep="dd if=/dev/urandom ibs=64 count=2 status=none|xxd -p -c0";ep | getline ex;close(ep);seedx=ex noncex px;dp="LC_TIME=POSIX TZ=fdpen962jq date";dp | getline hd;close(dp);mp="xxd -p -c0 <<< \047" hd "\047";mp | getline mx;close(mp);print hd "\n";ihx=sha512(ipad v0 "00");kx=sha512(opad ihx);vx=hmac(kx,v0);kx=hmac(kx,vx "01" seedx);vx=hmac(kx,vx);xx=kx vx;xx=drbg44(mx,xx);vx=hmac(substr(xx,1,128),substr(xx,129,128));xx=substr(xx,1,128) vx; if(length(bs)!=0) ix1=vx; else ix1=vx; xx=drbg44(mx,xx);xx=drbg44(ix1,xx);vx=hmac(substr(xx,1,128),substr(xx,129,128));xx=substr(xx,1,128) vx; ix2=vx; xx=drbg44(ix1,xx);xx=drbg44(ix1 ix2,xx);vx=hmac(substr(xx,1,128),substr(xx,129,128));xx=substr(xx,1,128) vx; ix3=vx; xx=drbg44(ix1ix2,xx);xx=drbg44(ix1 ix2 ix3,xx);vx=hmac(substr(xx,1,128),substr(xx,129,128));xx=substr(xx,1,128) vx; ix4=vx; xx=drbg44(ix1ix2 ix3,xx); for ( i=1;i<=16;i++ ) { xx=drbg44(ix1 ix2 ix3 ix4,xx);vx=hmac(substr(xx,1,128),substr(xx,129,128));xx=substr(xx,1,128) vx;ox=ox substr(vx,1,64);nx=substr(vx,65,64);xx=drbg44(ix1 ix2 ix3 ix4,xx);ix1=ix2;ix2=ix3;ix3=ix4;ix4=nx; } for ( i=1;i+1<=length(ox);i+=2 ) { bq=b[substr(ox,i,1)];q=bq substr(ox,i+1,1); if (bq in h || q in d) continue; o=o q; } while ( length(o)>=48 ) { op="echo " substr(o,1,48) "|xxd -pr";op | getline;close(op);print $0;o=substr(o,49); } if (length(o)>0) { op="echo " o "|xxd -pr";op | getline;close(op);print $0; }}'
